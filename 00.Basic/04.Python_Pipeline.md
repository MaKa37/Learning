# 파이썬 기반 데이터 파이프라인 설계 가이드
***
## 01. Type Hinting (타입 힌팅)

파이썬은 동적 타이핑 언어지만, 대규모 파이프라인에서는 데이터의 형태를 명시하는 것이 필수적입니다.

- **핵심 용어**: `Static Typing`, `Type Annotation`, `Callable`, `Optional`, `Union`, `Generic`.
- **가이드라인**:
    - 함수의 인자와 반환값에 타입을 명시하여 코드의 가독성을 높이고 버그를 사전에 방지합니다.
    - `typing` 모듈을 활용하여 복잡한 데이터 구조(List, Dict, Iterable)를 정의하세요.


***
## 02. MYPY (정적 검사 도구)

작성된 타입 힌트가 실제로 잘 지켜지고 있는지 실행 전 단계에서 검사합니다.

- **핵심 용어**: `Static Analysis`, `Linting`, `Type Consistency`, `Strict Mode`.
- **가이드라인**:
    - CI/CD 파이프라인에 MYPY 검사를 포함시켜 타입 불일치로 인한 런타임 에러를 차단하세요.
    - 점진적 채택(Gradual Typing) 전략을 사용하여 기존 코드 베이스에 적용합니다.


***
## 03. Pydantic (데이터 검증 및 설정 관리)

데이터의 런타임 검증(Validation)을 담당하는 라이브러리입니다.

- **핵심 용어**: `Data Validation`, `BaseModel`, `Type Coercion`, `Serialization`, `Schema Enforcement`.
- **가이드라인**:
    - 외부 시스템에서 들어오는 원시 데이터(Raw Data)를 Pydantic 모델로 변환하여 유효성을 즉시 검증하세요.
    - 환경 변수 관리(`BaseSettings`)에도 활용하여 설정의 일관성을 유지합니다.


***
## 04. 실전 데이터(JSON) 처리

대부분의 API와 웹 로그는 JSON 형식입니다. 이를 효율적으로 파싱하고 구조화하는 것이 중요합니다.

- **핵심 용어**: `Nested Structure`, `JSON Schema`, `Parsing`, `Flattening`, `Data Normalization`.
- **가이드라인**:
    - 중첩된 JSON 구조를 평탄화(Flattening)하거나 필요한 필드만 추출하여 메모리 효율을 높이세요.
    - Pydantic의 `alias`를 활용하여 API의 snake_case와 camelCase 불일치를 해결합니다.


***
## 05. 데이터 엔지니어링 아키텍처

파이프라인의 전체적인 흐름을 설계하는 단계입니다.

- **핵심 용어**: `ETL (Extract, Transform, Load)`, `ELT`, `Modularity`, `Scalability`, `Idempotency(재진입성)`.
- **가이드라인**:
    - 각 컴포넌트를 모듈화하여 재사용성을 높이고, 특정 단계 실패 시 재시도가 가능하도록 설계하세요.
    - 데이터 일관성을 위해 멱등성(Idempotency)을 보장하는 로직을 구현합니다.


***
## 06. 데이터 저장 과정 (Persistence Strategy)

데이터를 목적지(Data Lake, Data Warehouse)에 안정적으로 적재하는 과정입니다.

- **핵심 용어**: `Staging Area`, `Partitioning`, `Parquet`, `Upsert`, `Bulk Load`.
- **가이드라인**:
    - 분석 효율을 위해 CSV보다는 칼럼 기반 저장 형식인 `Parquet`을 고려하세요.
    - 날짜별 `Partitioning`을 통해 쿼리 성능을 최적화합니다.


***
## 07. DLQ (Dead Letter Queue) 개념과 전략

처리하지 못한 메시지나 데이터를 격리하여 분석 및 재처리를 돕는 장치입니다.

- **핵심 용어**: `Error Handling`, `Poison Message`, `Isolation`, `Retry Policy`, `Observability`.
- **가이드라인**:
    - 검증 실패(Pydantic ValidationError 등)가 발생한 데이터는 버리지 말고 DLQ에 기록하세요.
    - 실패 원인을 로그로 남겨 추후 파이프라인 개선의 피드백으로 활용합니다.


***
## 08. Async (비동기) 개념과 아키텍처

I/O 바운드 작업(API 호출, DB 쓰기)의 병목 현상을 해결합니다.

- **핵심 용어**: `Event Loop`, `Coroutine`, `await/async`, `Concurrency vs Parallelism`, `httpx/aiohttp`.
- **가이드라인**:
    - 수많은 API 호출이 필요한 경우 비동기 HTTP 클라이언트를 사용하여 네트워크 대기 시간을 최소화하세요.
    - 동기 코드와 비동기 코드가 섞일 때 발생할 수 있는 Race Condition에 주의합니다.


***
## 09. 데이터 통계 포털 API 기반 파이프라인 설계 (Case Study)

실제 공공 데이터나 통계 API를 연동하는 시나리오입니다.

- **핵심 용어**: `Rate Limiting`, `API Key Management`, `Pagination`, `Backoff Strategy`, `Data Refresh Cycle`.
- **가이드라인**:
    - API 서버의 `Rate Limiting`을 준수하기 위해 요청 간격을 조절하는 로직을 포함하세요.
    - 대량 데이터 조회 시 `Pagination` 처리를 자동화하고, 지수 백오프(Exponential Backoff)로 네트워크 오류에 대응합니다.